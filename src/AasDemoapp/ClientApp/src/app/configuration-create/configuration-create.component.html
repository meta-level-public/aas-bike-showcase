<div class="configurator-container">
  <!-- Header Section -->
  <div class="configurator-header">
    <h1 class="configurator-title">
      <i class="pi pi-cog"></i>
      {{ 'configuration.create.bikeConfigurator' | translate }}
    </h1>
    <p class="configurator-subtitle">{{ 'configuration.create.subtitle' | translate }}</p>
  </div>

  <!-- Main Content -->
  <div class="configurator-content">
    <!-- Left Panel - Available Parts -->
    <div class="parts-panel">
      <div class="panel-header">
        <i class="pi pi-shopping-cart"></i>
        <h3>{{ 'configuration.create.availableRawParts' | translate }}</h3>
        <span class="parts-count"
          >({{ rohteile.length }} {{ 'configuration.create.parts' | translate }})</span
        >
      </div>

      <div class="parts-grid p-4">
        <div
          *ngFor="let rohteil of rohteile"
          class="part-card"
          (click)="addToConfiguration(rohteil)"
        >
          <div class="add-btn-overlay">
            <i class="pi pi-plus"></i>
          </div>
          <img
            [src]="'data:image/jpeg;base64, ' + rohteil.image"
            [alt]="rohteil.name"
            class="part-img"
          />
          <h4 class="part-name">{{ rohteil.name }}</h4>
          <p class="part-category">
            <i class="pi pi-tag"></i>
            {{ rohteil.kategorie }}
          </p>
          <div class="part-price">
            {{ rohteil.price | currency: 'EUR' : 'symbol' : '1.2-2' }}
          </div>
        </div>
      </div>
    </div>

    <!-- Right Panel - Configuration -->
    <div class="configuration-panel">
      <div class="panel-header">
        <i class="pi pi-wrench"></i>
        <h3>{{ 'configuration.create.configuration' | translate }}</h3>
        <span class="selected-count"
          >({{ bestandteile.length }} {{ 'configuration.create.selected' | translate }})</span
        >
      </div>

      <!-- Product Details -->
      <div class="product-details">
        <div class="form-group">
          <label for="productName">{{ 'configuration.create.productName' | translate }}</label>
          <input
            id="productName"
            type="text"
            [placeholder]="'configuration.create.nameEnter' | translate"
            pInputText
            [(ngModel)]="newProduct.name"
            class="product-name-input"
          />
        </div>

        <div class="price-display">
          <div class="price-label">{{ 'configuration.create.totalPrice' | translate }}</div>
          <div class="price-value">
            {{ newProduct.price | currency: 'EUR' : 'symbol' : '1.2-2' }}
          </div>
        </div>
      </div>

      <!-- Selected Parts -->
      <div class="selected-parts">
        <div *ngIf="bestandteile.length === 0" class="empty-state">
          <i class="pi pi-shopping-basket"></i>
          <p>{{ 'configuration.create.selectParts' | translate }}</p>
        </div>

        <div *ngFor="let teil of bestandteile; trackBy: trackByFn" class="selected-part-card">
          <img
            [src]="'data:image/jpeg;base64, ' + teil.image"
            [alt]="teil.name"
            class="selected-img"
          />

          <div class="selected-part-info">
            <h4>{{ teil.name }}</h4>
            <p class="selected-part-category">{{ teil.kategorie }}</p>
            <div class="selected-part-price">
              {{ teil.price | currency: 'EUR' : 'symbol' : '1.2-2' }} /
              {{ 'configuration.create.piece' | translate }}
            </div>
          </div>

          <div class="quantity-controls">
            <span class="quantity-label">{{ 'configuration.create.quantity' | translate }}</span>
            <div class="quantity-input-group">
              <button
                type="button"
                class="quantity-btn"
                (click)="decreaseQuantity(teil)"
                [disabled]="teil.amountToUse <= 1"
              >
                <i class="pi pi-minus"></i>
              </button>

              <input
                type="number"
                [(ngModel)]="teil.amountToUse"
                (ngModelChange)="onQuantityChange(teil, $event)"
                min="1"
                class="quantity-input"
              />

              <button type="button" class="quantity-btn" (click)="increaseQuantity(teil)">
                <i class="pi pi-plus"></i>
              </button>
            </div>
          </div>

          <div class="part-total">
            <div class="total-value">
              {{ teil.price * teil.amountToUse | currency: 'EUR' : 'symbol' : '1.2-2' }}
            </div>
          </div>

          <button
            type="button"
            class="remove-btn"
            (click)="removeFromConfiguration(teil)"
            [title]="'configuration.create.removePart' | translate"
          >
            <i class="pi pi-trash"></i>
          </button>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button
          pButton
          type="button"
          [label]="'configuration.create.clearConfiguration' | translate"
          class="p-button-outlined p-button-secondary"
          (click)="clearConfiguration()"
          [disabled]="bestandteile.length === 0"
        >
          <i class="pi pi-trash"></i>
        </button>

        <button
          pButton
          type="button"
          [label]="'configuration.create.createConfiguration' | translate"
          class="p-button-success create-btn"
          (click)="createProduct()"
          [disabled]="!valid()"
          [loading]="loading"
        >
          <i class="pi pi-check"></i>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Confirm Dialog -->
<p-confirmDialog></p-confirmDialog>
<p-toast></p-toast>
